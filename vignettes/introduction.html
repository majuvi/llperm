<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>introduction</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">introduction</h1>



<div id="preliminaries" class="section level1">
<h1>Preliminaries</h1>
<p>Load the required libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(llperm)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div id="load-the-data-set" class="section level2">
<h2>Load the data set</h2>
<p>Load the data set. We have three data frames: OTU table, taxonomy table, and person metadata.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fn.sequence <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;VEGA_sequences.txt&quot;</span>, <span class="at">package =</span> <span class="st">&quot;llperm&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fn.taxonomy <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;VEGA_taxonomy.txt&quot;</span>, <span class="at">package =</span> <span class="st">&quot;llperm&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fn.metadata <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;VEGA metadata.txt&quot;</span>, <span class="at">package =</span> <span class="st">&quot;llperm&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>otu.table    <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">read.table</span>(fn.sequence, <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>otu.taxonomy <span class="ot">&lt;-</span> <span class="fu">read.table</span>(fn.taxonomy, <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>, <span class="at">stringsAsFactors=</span>T)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>otu.metadata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(fn.metadata, <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the reference level to the most common category</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>otu.metadata <span class="ot">&lt;-</span> <span class="fu">with</span>(otu.metadata, <span class="fu">data.frame</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> Age,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">UrbanizationLevel =</span> Urbanization_level,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gender =</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(Gender), <span class="st">&quot;Female&quot;</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Diet =</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(group), <span class="st">&quot;meateater&quot;</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Low education has only 4 observations</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Education =</span> <span class="fu">factor</span>(education, <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Middle&quot;</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;MidLow&quot;</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;MidLow&quot;</span>, <span class="st">&quot;MidLow&quot;</span>)), </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">PetAnimals =</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(Pet_animals_at_home), <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">TravelToSE =</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(Travel.to.Southern..or.Eastern.Europe.in.the.past.<span class="fl">6.</span>months), <span class="st">&quot;No&quot;</span>), </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="fu">rownames</span>(otu.metadata)))</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Take only persons with both microbiome information and demographic information</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>sample.ids <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">rownames</span>(otu.table), <span class="fu">rownames</span>(otu.metadata))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>otu.table <span class="ot">&lt;-</span> otu.table[sample.ids,]</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>otu.metadata <span class="ot">&lt;-</span> otu.metadata[sample.ids,]</span></code></pre></div>
<p>Having the data inside a single phyloseq object allows easier data manipulation:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">phyloseq</span>(<span class="fu">otu_table</span>(otu.table, <span class="at">taxa_are_rows=</span><span class="cn">FALSE</span>), </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sample_data</span>(otu.metadata), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(otu.taxonomy)))</span></code></pre></div>
</div>
<div id="filtering-and-transforming-data-for-analysis" class="section level2">
<h2>Filtering and transforming data for analysis</h2>
<p>We limit our analysis to the VEGA study which has 4 diet groups and 149 persons x 6385 OTUs:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">=</span> <span class="fu">subset_samples</span>(ps, Diet <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;meateater&quot;</span>, <span class="st">&quot;fisheater&quot;</span>, <span class="st">&quot;vegetarian&quot;</span>, <span class="st">&quot;vegan&quot;</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ps</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; phyloseq-class experiment-level object</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; otu_table()   OTU Table:         [ 6385 taxa and 149 samples ]</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample_data() Sample Data:       [ 149 samples by 7 sample variables ]</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tax_table()   Taxonomy Table:    [ 6385 taxa by 6 taxonomic ranks ]</span></span></code></pre></div>
<p>We also filter those taxa in the full OTU table with less than 10% prevalence, leaving us with 595 OTUs:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>otu.prevalence <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">otu_table</span>(ps) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">nsamples</span>(ps)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>otu.keep       <span class="ot">&lt;-</span> <span class="fu">taxa_names</span>(ps)[otu.prevalence <span class="sc">&gt;=</span> <span class="fl">0.10</span>] <span class="co"># #0.10</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>ps<span class="ot">&lt;-</span> <span class="fu">prune_taxa</span>(otu.keep, ps)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>ps</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; phyloseq-class experiment-level object</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; otu_table()   OTU Table:         [ 595 taxa and 149 samples ]</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample_data() Sample Data:       [ 149 samples by 7 sample variables ]</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tax_table()   Taxonomy Table:    [ 595 taxa by 6 taxonomic ranks ]</span></span></code></pre></div>
<p>To analyze the data with a simple linear model we use the relative abundance transformation. Normalize the row counts by the total count per row:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relative abundance and Log-transformed absolute abundance</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ps.rel <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(ps, <span class="cf">function</span>(x){<span class="fu">log</span>((<span class="dv">1</span> <span class="sc">+</span> x) <span class="sc">/</span> <span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">+</span> x))})</span></code></pre></div>
</div>
<div id="data-frames" class="section level2">
<h2>Data frames</h2>
<p>Add a random diet group to test the results when there is ‘no signal’</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>DietRandom <span class="ot">&lt;-</span> <span class="fu">sample_data</span>(ps)<span class="sc">$</span>Diet[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nsamples</span>(ps))] </span></code></pre></div>
<div id="otu-counts-otu.counts" class="section level3">
<h3>OTU counts (otu.counts)</h3>
<p>Data frame of counts]</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>otu.counts   <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">otu_table</span>(ps), <span class="fu">sample_data</span>(ps))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>otu.counts<span class="sc">$</span>DietRandom <span class="ot">&lt;-</span> DietRandom <span class="co"># Random permutation of diet group labels</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>otu.counts<span class="sc">$</span>library_size <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">otu_table</span>(ps))</span></code></pre></div>
<p>Visualize the ‘ASV159’ as an example taxa:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(otu.counts, <span class="fu">aes</span>(<span class="at">x=</span>ASV159, <span class="at">color=</span>Diet, <span class="at">fill=</span>Diet)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="otu-relative-abundances-otu.relative" class="section level3">
<h3>OTU relative abundances (otu.relative)</h3>
<p>Data frame of relative abundances</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>otu.relative    <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">otu_table</span>(ps.rel), <span class="fu">sample_data</span>(ps.rel))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>otu.relative<span class="sc">$</span>DietRandom <span class="ot">&lt;-</span> DietRandom <span class="co"># Random permutation of diet group labels</span></span></code></pre></div>
<p>Visualize the ‘ASV159’ as an example taxa:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(otu.relative, <span class="fu">aes</span>(<span class="at">x=</span>ASV159, <span class="at">color=</span>Diet, <span class="at">fill=</span>Diet)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="experiments" class="section level1">
<h1>Experiments</h1>
<p>Run the experiments over these OTUs:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>taxas <span class="ot">&lt;-</span> <span class="fu">taxa_names</span>(ps) </span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Faster alternative, only use 100 OTUs: </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#taxas &lt;- sample(taxas, 100, replace=F)</span></span></code></pre></div>
<div id="original-prr-test-implementation" class="section level2">
<h2>Original PRR-test implementation</h2>
<p>The original implementation of glmperm does not support factors with several levels, so we create a new binary indicator vegetarian or vegan = Y/N</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binary vegetarian Y/N</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>otu.relative<span class="sc">$</span>DietVeg <span class="ot">&lt;-</span> <span class="fu">factor</span>(otu.relative<span class="sc">$</span>Diet, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;meateater&quot;</span>, <span class="st">&quot;fisheater&quot;</span>, <span class="st">&quot;vegan&quot;</span>, <span class="st">&quot;vegetarian&quot;</span>), </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;yes&quot;</span>))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>otu.relative<span class="sc">$</span>DietVeg <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(otu.relative<span class="sc">$</span>DietVeg <span class="sc">==</span> <span class="st">&quot;yes&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Binary vegetarian Y/N from randomly permuted diet</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>otu.relative<span class="sc">$</span>DietVegRandom <span class="ot">&lt;-</span> <span class="fu">factor</span>(otu.relative<span class="sc">$</span>DietRandom, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;meateater&quot;</span>, <span class="st">&quot;fisheater&quot;</span>, <span class="st">&quot;vegan&quot;</span>, <span class="st">&quot;vegetarian&quot;</span>), </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;yes&quot;</span>))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>otu.relative<span class="sc">$</span>DietVegRandom <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(otu.relative<span class="sc">$</span>DietVegRandom <span class="sc">==</span> <span class="st">&quot;yes&quot;</span>)</span></code></pre></div>
<div id="linear-model-on-relative-abundances-diet" class="section level3">
<h3>Linear model on relative abundances (Diet)</h3>
<p>Apply the original glmperm implementation to the example OTU:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">prr.test</span>(ASV159 <span class="sc">~</span> DietVeg <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> Education <span class="sc">+</span> PetAnimals <span class="sc">+</span> TravelToSE, <span class="at">var =</span> <span class="st">&quot;DietVeg&quot;</span>, <span class="at">data=</span>otu.relative, <span class="at">nrep=</span><span class="dv">1000</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Permutation of Regressor Residuals Test:</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call: </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  prr.test(formula = ASV159 ~ DietVeg + Age + UrbanizationLevel +      Gender + Education + PetAnimals + TravelToSE, var = &quot;DietVeg&quot;,      data = otu.relative, nrep = 1000) </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; number of observations used:  149 </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; null hypothesis: regression coefficient of covariate DietVeg = 0</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; observed Likelihood Ratio Test Statistics:  8.6979 </span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     -----------------------------------------</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Results based on chi-squared distribution </span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     -----------------------------------------</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; observed p-value: 0.0032 </span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ---------------------------------------------------</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Results based on permutation of regressor residuals </span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ---------------------------------------------------</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; permutation p-value for simulated p-values &lt;= observed p-value: 0.005 (Std.err: 0.0022) </span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; permutation p-value for simulated p-values &lt;= 1.005 observed p-value: 0.005 (Std.err: 0.0022) </span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; permutation p-value for simulated p-values &lt;= 1.01 observed p-value: 0.005 (Std.err: 0.0022) </span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; permutation p-value for simulated p-values &lt;= 1.02 observed p-value: 0.005 (Std.err: 0.0022) </span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; permutation p-value for simulated p-values &lt;= 1.04 observed p-value: 0.005 (Std.err: 0.0022)</span></span></code></pre></div>
<p>Apply the original glmperm implementation all OTUs, saving the likelihood and PRR test based p-values for Diet and DietRandom:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pvals.data.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>pvals.null.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>pvals.data.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>pvals.null.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(taxa <span class="cf">in</span> taxas) {</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(taxa)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  eq1 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s ~ DietVeg + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE&quot;</span>, taxa))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  eq2 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s ~ DietVegRandom + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE&quot;</span>, taxa))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">prr.test</span>(eq1, <span class="at">data=</span>otu.relative, <span class="at">var =</span> <span class="st">&quot;DietVeg&quot;</span>, <span class="at">nrep=</span><span class="dv">100</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">prr.test</span>(eq2, <span class="at">data=</span>otu.relative, <span class="at">var =</span> <span class="st">&quot;DietVegRandom&quot;</span>, <span class="at">nrep=</span><span class="dv">100</span>) </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  pvals.data.obs[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.obs</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  pvals.null.obs[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.obs</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  pvals.data.sim[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.perm<span class="sc">$</span>p0</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  pvals.null.sim[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.perm<span class="sc">$</span>p0</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Likelihood:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.obs, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.obs, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Likelihood: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> PRR test:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.sim, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.sim, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;PRR test: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="new-prr-test-implementation-for-any-model" class="section level2">
<h2>New PRR-test implementation for any model</h2>
<div id="linear-model-on-relative-abundances-diet-1" class="section level3">
<h3>Linear model on relative abundances (Diet)</h3>
<p>Apply the new glmperm implementation to the example OTU:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new</span>(ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> Education <span class="sc">+</span> PetAnimals <span class="sc">+</span> TravelToSE,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>otu.relative, <span class="at">test.var =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">method=</span><span class="st">&quot;glm.fit.fixed&quot;</span>, <span class="at">family=</span><span class="fu">gaussian</span>())</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.0009080735</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.002</span></span></code></pre></div>
<p>Apply the new glmperm implementation all OTUs, saving the likelihood and PRR test based p-values for Diet and DietRandom:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pvals.data.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>pvals.null.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>pvals.data.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>pvals.null.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(taxa <span class="cf">in</span> taxas) {</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(taxa)</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  eq1 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s ~ Diet + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE&quot;</span>, taxa))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  eq2 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s ~ DietRandom + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE&quot;</span>, taxa))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">prr.test.new</span>(eq1, <span class="at">data=</span>otu.relative, <span class="at">test.var =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">n.rep=</span><span class="dv">100</span>, <span class="at">method=</span><span class="st">&quot;glm.fit.fixed&quot;</span>, <span class="at">family=</span><span class="fu">gaussian</span>())</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">prr.test.new</span>(eq2, <span class="at">data=</span>otu.relative, <span class="at">test.var =</span> <span class="st">&quot;DietRandom&quot;</span>, <span class="at">n.rep=</span><span class="dv">100</span>, <span class="at">method=</span><span class="st">&quot;glm.fit.fixed&quot;</span>, <span class="at">family=</span><span class="fu">gaussian</span>()) </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  pvals.data.obs[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.obs</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  pvals.null.obs[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.obs</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  pvals.data.sim[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.sim</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  pvals.null.sim[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.sim</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Likelihood:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.obs, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.obs, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Likelihood: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>PRR test:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.sim, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.sim, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;PRR test: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAIAAACb4TnXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAcZklEQVR4nO3df2wb53kH8IdN42pJvDapEwcl6YgxqQ2KgAyOWyLHuBANDC1piBUwQfOaVO62jLQG1KQKOEYjowsCO4BmICKDAQ4JDIvdxDNsbXA5mGzXLQqm6BJhntEAirCIdKmEZFcnadMtP+okdbk/7vfxSB4lvbwj/f0gaHnvve9771F8/L733vGlo1arEQCw8RmrGwDQyxBgAAwhwAAYQoABMIQAA2AIAQbAEAIMgCEEGABDXRBgxVTAUS8QS+WLLfI4HIFATJXLbLb6FsQCsfxmnIn5eoqpgMNhmDkfczgCqaKSS9rYrEN3i3xM+ms2/eux1Pr974IAM8ZnEmFfy48Mz2dM5GqRrXjxXIZvv4XM6umuQ7OSj4VVp+S1sCVNdUuARXM1jUIuSkSZY+p/PPR5arVCLsrpc5nN1hW88cVabTFu248Xa+LfMh2yuiENdUuA6XlD6VyUiF8ptMh1NGqqskbZiqmAw5fgiTJh9VigqAxP6oaXxZS8zyHvM6onH3M0GAWaphuimD609hQcdSNk9fnFUnnVcFUcukqDbbFgMR8LKKPvQEzVIqGBUoXSLql+VVbD8zNuZD7mcIQzJJySwVsojaLl0k0PYzQa1/xtGp5dfTWa4WIxFXB0a4CZUizmY+HMZmVT8qcCPmV4wvOZsE9+X4upgC+hDF3MjVA3RzuHzsfUp0CaU9CfXyYRTuiGl8vHDghJ3KDPK+VX8vCZhPbQKycOiBXymcSBVD4VkOqvy2q2ka2tnJCPQnwm0bisd984R5kL6lbkL2SIoqMhIhNn15x+uGQ/hSTXaIgoJxeSXONTVMqazNa0AUIdXDRXkFqS5OTShSSn2afa1eBEmp51Q1yyoOQSNto4tFi3Lq9UqfDOcklhr3h6cmltXvWR6hLUpyHsFv9qcnHxvVTqqn8DGjRSbGaDd1M6TFR7Ds3/wqpmqOpuenaagvpKxJQGh7SRxh815Wwa5OE41TtjPptRAzQfVd1HQskgfmK4aDKZK+ir7ECAmTq0NvYEuahUq/JK2xRNgBmcRaFQyOWSyWiUkz7cRtl1tRu9m2YaWTMRYNpqm2XXt8Mgr/HZmQiwbh0iclw0V9Bd3at6qlyUI+Ki46fSoboJAJPZGiis8ER8wqee5fcleKLl1SKRN340SsTzmUQi7PPV3U1ol+EHQvrnWafNQwvjH1loVKy1uLpMxI3vU70f3n3jumDnBn3qzWIq4HD4fL5wOJHIGMxW6rLT0IBUu3dgqGELmzTSFOUoRES+QU74G+lu1QgDR+++cY74cxeF60NlfGjm7JrrlgDTf9QWF5vFhDeUXsxFmw6828jWllC6VsglpX/oTN5N6OpD52O+BE/ERaPJZC6XKxQa/RNgZ6oI08bXRs+uWwKsfeI0Y+JA89gxmU3mG2wwzlO6U28onl4UxhW5ZJRIdwHNkvlD63bkL4izPN6BIZL/LRcUL55r8u92cXWZKJqrLabT8XgoFPJ6i6vLGzyNVo00ZXm17hyGBrzCnY36P5scYdr4auPshHdOPa1dWOF7OMCU2DnR/ONtLpv05xKmnMIBZfhVzKcC0pxuPuZwOOR9Xq9vYJDTDpE0f/bNZP7QwpAvE5anvYupQDgjDQxDo+I/ONIEfOqAfhKxXuaCXFc+JuTf4Ik2b6QZ9eegG3EaHJBfOaEdHxJRe2eXuaA8ZBPOUNdMcrSYG2iUp6CdPjKZzXivbppNSzPr0Gqfup5GJ9b4rHNRw0mONg9dl7fVjJHBZX2z7Jq5TcP5ubqTqT/RJo00McnBaYu3nF6ST0Sds+nZGU2OqPJEo907yWGSN34qKf5DuP5s3vhR4U/NrxSKJFzrKJc62vkWb3yxyT5tPZusnUOH0tq8mhkjb3yxoHy4uagw2Gxy3FM5dVXJXMHEMwAmNG1ka0NHF6V2cdFkrtDycQ9pMkfTf7VzdqG03F4umiwsHh4kctSwqhS0kI85wsvJtj7d1srHHOFMNGeHR6h6vAeDtgnT2DH1I1XhjH7SG8xCgIGWOLsg3+nzhTNEXPKw9Z1BV0KAgU6zazloF67BABhCDwbAEAIMgCEEGABDCDAAhhBgAAx91uoGtLC6ump1E2hgYKA+0bYNA1tBDwbAEAIMgCEEGABDCDAAhhBgAAwhwAAYQoABMIQAA2CoNwKscjY6PMMr/988V7OUjpEPbatWwWaz+5Mc7XHtz7zEMj9Am+zeg4n/kBv/o87PDA8Hg8Hh6AtvGmST9oop/MwjzxYcP3pcXY+6G4mePTszHAwGg8Gg2e7DsPOpr0edzXTvtKCthJ8ZVmqLnq0QPzM88+yz+B6/3dk9wB4XPlau/ZmXjugWqONnHr9y8Pn5+fmXvk0/Kjiowd7nD155fIYn4o48f9BX+/pTdfWIVp998Z7n5+fn549/Pf/c2YqZxhm1aj31GMhf0VbC7QldeatCRPTWm7T3IRcRUf7JH35jndVDp9g9wBqFAxG/kA99e7+LiIh7OOar1e0dED6Hrv3fDuUXTHQaUm077hlYffMtza6ftNPkJvVsoBJuz84XX64Q8QtXxPgi2v/dg+usHjrF7tdgZyu032W0o/LWFaI94oZrx056U59jNf2tYJqIiGrku6dCzX4OqLmfXaF7/3jdpTfJjnvouZcrO968svdh8Q0ZGNhpbZOgNbsH2LNPnn0oYxRimpjSRJskdHxe2/2td7hG9xp8kCtEhoHPjOuhvfTCCwtKfEE3sPsQsTFuT0i6xuFfSOuvwdR7Z4aj674WEmys+3Lt2EniBVTl5RfX/TUy10N7r+SV8SHR6pN/19bYFSxg9wB7Sui+jCbfuCPP733xkWAwOPwcfV1/DUbckad2PvtIMBgcfvzKwe/vdxGR66G9A/nHN+kWU6NWGeEePkjpbwWDweCTtHf9E3+uh/YO7Nyh9F8D++npdVcGnWH3dRFt+8VhCxpWORt9YUdGHPbyM8PPffnllw7e2+lWQFvs3oOBoHI2OvzIi3sfXv9MDVgCPVhrdunB6mBNDvtDDwbAEAIMgCEEGABDdr/RfMcddxDRtm3b3n33XTnRqs2uaBjYCnowAIYQYAAMIcAAGEKAATCEAANgCAEGwBACDIAhNvfBqnPxyfI3s1N+eet0SdoXnBbTl2Yjx+eJyDNxMjXmbFrfx0cObVVvzzyz6U0GYIFBgImBE5QTKuWSHFWS6lz8OE1ns36qzsUnZ9263fU+vX+X8OLm1y5vepMBGNnkIeLSbCRyfG1iesKjpFXLax63/mvulXIpyPmJiJwP7vHM80ub2w4Ae9jkHsw/lc1OEVXnFpS0SrlUmp+MnCYieYBYLa953OPCfqe7nxbKVfJLw8Tdu3fLhS9dukREHxP19fUJKdeJiGjbtm3q43Zssz7dqpY0ahjYCvtnEavlNeUyqzoXj8+5UmOVconcjUoIQSUQnrjbSnTt2jUh5WZVuoD1I3+GH2Uhm7XPIiLG7I99gDnHUtkxecPdX+IrRC63p1kZgB5h0TS9091fKosrPVXLa9Tvbj6NCNCd2AfY0mwkPlcVN6rlNWFuw+X2zJ+ZqxJR9ZUFab4DoNewHyL6p06W49Ich2fiZEqYOxxLTZcjk5HTqjSAnsMmwJxjqax2a6w+kzjjCNDD8KgUAEMIMACGEGAADCHAABhCgAEwhAADYAgBBsAQAgyAIQQYAEMIMACGEGAADCHAABhCgAEwhAADYAgBBsAQAgyAIQQYAEMIMACGEGAADCHAABhCgAEw5KjVala3obWPjxy6yc8Jr68v8Z/DzxdBl2C/LuLGYG36dhsGtoIhIgBDCDAAhhBgAAwhwAAYQoABMIQAA2AIAQbAEAIMgCEEGABDCDAAhhBgAAwhwAAYQoABMIQAA2AIAQbAEAIMgCEEGABDCDAAhhBgAAwhwAAYQoABMIQAA2AIAXYjK6YCDkcsb5Bal9i0jkCq2H6GlgV7ApsAq87FI7NLyvbSbCQSiUQi8blqi0ToJO++cY4yF7TBVLx4jo+OhkzXEV+sLca9m962HsEgwJZmI5OnS8p2dS5+nKaz2Wz25J6FSTHuDBOh07z7xjlaXlV3I23GFzS3yQG2NBuJHF+bmJ7wKGmVcinI+YmInA/u8czzSw0ToeO88aNR/txFJcI08VVMBRwKcTxXTAUcsZS4J5ZXj/QM8wsuxoxSlcOqSpofnnaDGguV84dGnn5Vfn3ofEXc8erTI4fOVxokSh5QEVKuPfadT//pH4X/rj32HSZtvmHlosQlC+JGIclRNCfvkF/XCklO3CokOdLtEMo3zS8eQklWFVQlqpN7Avu16SvlErlNJUouXbokv8ba9O02rG2h0Wj42MViPO4V+6+jQv9V9B2u1eRrK+++cS5xbrVIwk6DQWTz/EeFyzRv/FTynO9Y6nAoLhfMn0jw0dyiWKE3fjSaCJ/Ix9M9MUxlP4vocntMJoI1QqPSKFEzPvR6vUSUl4Z2vgSvFOEGfXXVNMuvikfvwBDxKwVlX3F1mSgTVoaW4Qzprgu7GPsAc7r7S+WK8LpaXqN+t7NBIlhEijDd/EY+5nA4wsvicE0Y6TXTbn6VujFhz8xLduA+mMvtmT8zVyWi6isL0tSGYSJYRIiwvC6+LmS4ZEH+qBdW+IblW+ZXdUjF1WVtB+gdGCLNPEtP6UCAOcdS0/2nJyORyOTCnpNT/saJYJXQaJQ/d6xufl7+3BdTgXCmdTUN8/OJA9IU5IEEL12QSQc/nOTkDEJH2Ds3oNlMcjjHUln1tn8qm53SZzJMBGuERqPhTEaa3xCS0rmoI+xzJIiIuGQhN+QLrxSI6q++WufnkuMrPoeDiCiaq+mnL7zxxQIFfGJR4pKFnhkh2v4XLqFDQulaLd0iTfy14fhiTZkCJK+y2Tx/PK6t36uux6uttHeYGSLmY/U3/4zSAEAHD/sCMNRsiFhMBZSbGWGH/iI3muuJO4EADDXrwbzxxVqtpnsERtEbd9oBWDIzyRFKi1erANAec9dg2qeke/OpZwAGzPRgws3B+tsX0PXef//9jVeydevWjVfSq8wEWGGFJ80tSOgVW45Nb0ItM89sQiU9ykyA+QY5WmHeErDG73Z9eSPFP3P5PzerJT3JzDWYN340mgnjigugbeae5AhntN/YwSQHgClmp+n1j6kBgAl4VAqAIbMP+xrBEBGgBTMBFkrrn5ISFiLCfTGAFtY3RAylc0PKV1AB6tU9/aMMeJqvzd3eyt12t4FrMM3SQAD11I+I5ygsxY03vnjDPBa0zgDLX8gYLt0F0EAoXUguH0sVSddHyVf4Qko+5kvwlAn3Sie2zkmOcIZLnuqZdROgI7wDQ3WrR+Vj4jpvheRyOJYX4pAzWrijS+E+GHSMb1C/VGL+QoYbL3hJeFzIcSGfDvVGXMnsvuiNsDr0x0R9fX1CynVVui5bBzbr061qyeasm91RhRWeBvWJfEJaTYqIG5SW2u4ZZgNMs3xAB1fWwtr07TbMvuTuSjNKrBsN9tbctKlJjmIq4EsMqWeEhhK+3lkbEjohHwtndCuOEoVGoxlh4oPysR5ablRhapLjRIKP5tK6NSn5xInemOcBZjQ/6UBGExehdG4o4XMIi9oL02befeNc78wi2v0aDLpVk6VEvfFFZZGX+im0nlqE1NSjUoeTnPb7YPlYOMMlD/fY9SjApjPVg4lrhwtrixNRjy0fDsCM2SFiT3Xb9nbn8htERCT8L70z9AcWNgY2qCuvwT4+ckhex+j9w9+3silsTNzxhb6+vmvXrp3+1a+tbgtsiMkAK6YCvnPjwrBQmrS37lmWm/yccFvs5tcuW9WGnoFVa5gyFWD5mC8xlKuJF13SFVnMFs+LbT3x5MdEQofWk70ZU32hP914JVj2uQkzAZa/kNH90oPwS/C2eHLs0/t3CaOpruvNHC8tqjdrw9Y8lvHn2+7YSPF/ePdXm9WSntSV12CNbD3xJBEJHVpX9GYTd3xBeIFrrV5l6mn6w0nOF46NKiNC4T5YwfLuS+fT+3cRUV9f3/WlFj/YDdAZZu+D1QZiDtwHs5Q0fS94A9P3XcH0EBFfCmuH7l6W5A2DrBLdJZkhDCm7Tk9dg9mK+l6WEBh9fX2Zn/+iUZBEv3S3cO8BwdNLsPAoAEMIMGDD4EcbN/gNlE1az62z68khwIAdzS97F5LLYbt8pbJz68khwKBDvPvGOXktTVU3In64i6lAIJWK1Xd20qJmgROqH6nL12XUlA+kikq5FkHNdj05BNiGOF5avHP5Dfk/q5tja8WL53hxLc18zHduvCD3a9JHlk+cGywIS7NLCwko67rVjlJGurupJOZI1SvyiZVRoU5K+BwX5NetvnrPcj05BNhGTdzxBeE/qxtiQ5rflJOfFicKpWvSbVTvwJCSX1qzwzco9XX5C/JCHqHDSXHVN3XiaFSJDek7wN5945z8emCIlldbDEwbrCe3T1pPLnNh3Zd+CDBgR7rUyUWJ9CvVSiOwcKZJBcXVZWVDikVNYn1srENhxeDJH15YK8ThCGdah2hDnbgPVp2LT54uSVvB6eyUn4hoaTZyfJ6IPBMnU2PODrSDPTM3i29EoXQhGfD5YgPi+Cofc4QpV6ulhS8/Nf4BcO/AkPLz4MXVZaJRXaLhWottYrmeXCd6sEq5FJzOSoToqs7Fj9N0NpvNntyzMDm71IFmdED0S3djuGjIGz+lLOxSXF2m6Kjy4W3SP6jXdTshLcypTpSHcuvGdj25DgRYtbzmcbt0iZVyKcj5iYicD+7xzPM9EmHQkBhigVSRvPFTyWXx8uzAyhDX7Hd6QunC+Dmfw+FwHKMoJyfKi71Rbj0PxXZuPbkODBEr5VJpfjJymojkAWK1vOZxjwv7ne5+WihXyS8NE3fv3i0XvnTpEhktnS1sXpde9PX1XVflIdXK0ur1BYiIZp7Z1KWz31AflFRtkBtG2oY1et2orLoBhidoU5q12eSUeN1LIhKecVXl15RV55WfhjVc7G3R6HUoXQvpM3ZwPTn2AVYtrymXWdW5eHzOlRqrlEvkblRCCCpBo6WzxSUDiK5duyZ+4VJKFD6F8kLTW6WvsZC0xMAmLp1NqobpNuWGkbZh6vxmysprdOvyd9/S2Tck9gHmHEtlx+QNd3+JrxC53B7mBwawnkXT9E53f6lcEV5Xy2vU7+6NaUQALfYBtjQbic9VxY1qeU2Y23C5PfNn5qpEVH1lQZrvAAPCMyK4AdCl2A8R/VMny3FpjsMzcTIlzB2OpabLkcnIaVUaGFF/l4xF/Vi1hqlO3GjWXIUp/FPZ7FQHDm+CsFoOddWCOZuiNhywugk9Dt9oFmHBHGABzyICMHTj9mDqRRQBGLlxA4y6eVVg6BY9G2DyvAWAhXo2wHSPRwFYApMcAAz1bA/WiP7hegCWbrgAw4/3QSdhiAjAEAIMgCEEGABDCDAAhhBgAAwhwAAYQoABMHTD3QczQ/39S7phvnwJLCDADOA5RtgsGCICMIQAA2AIAQbAkN2vwYTVodexNr06/0bKWr42faP8WDe7K9g9wNa9Nr06/0bKWr42faOyWJu+K2CICMAQAgyAIQQYAEMIMACGEGAADCHAABhCgAEwhAADYAgBBsAQAgyAIQQYAEMIMACGEGAADCHAABhCgAEwhAADYAgBBsAQAgyAIQQYAEMIMACGEGAADCHAABhCgAEwZGGALc1GIpFIJBKfq1rXCACmrAqw6lz8OE1ns9nsyT0Lk7NLFjUDgC2rAqxSLgU5PxGR88E9nnkeEQY9yVGr1Sw4bHUu/rf0WGrMSUS0NBs54z4pbhDR7t275YyXLl0ioo+PHLKgkURE9LmZZ5rsdby02LGW6NSGA1YdGsyzaG36SrlE7kY7haASCEvAb5t5Rl4Lnoi2bdvWyc0ma9PXhgN2axjYikVDRJfbY82BATrKogBzuvtL5Yrwulpeo363s3kBgK5k1SSHy+2ZPzNXJaLqKwvSfAdAr7Hq98GcY6npcmQycprIM3EyhfiC3mThD/D5p7LZKesOD9ABeFQKgCEEGABLtW7wwAMP2HCvnRsGNoEeDIAhBBgAQwgwAIYsetgX4MaAHgyAIQQYAEMIMACGEGAADFn4LKLa0mzk+DwJD/6O1X1z5Qd/FTl/lYi27Hpi7olduiKue2+p/OwjIiL6ynT2qJ+IqDoXnzxdqjtKcDo75VeXNdptXFZpmLqpv3nC2oZp3q7m7yFYxOo73bVarXL+0MjTr2pfKf7rb/5k5NHT2ldKxouTIyMj3321VqtV/n5iZOQvz1dqtVrt1aeFvZWn/0wsoapZe7jvfW9kZGRk5NGRQ0JRpez5QyPxR0eeflX1SlP20ZFRyxpW93Y1fw/BMnYYIjZfAOf16ifbv/otIqJdkaEtV//jB+oiSy9XaPtdBX6JyPm1ke309uUKEVXLax63i4heW/vgtsG9upqVw1X+u0TLa8Hp4G30YfAx4V99uWylXBq65WqQ85PzwT2en926fZ5f0jT1zpuv9+20pmH1bxcWEbIpGwwRq+U1j3tceO1099NCuUp+eYhz+cp7W5z3Ca937bydlq9cJtouFXHt8njKd5bWylXyO39DtGXLzURUKZdK85OR00REVJqMCIOu7eQpV8lPyuH8R6eDkTOff/WnH1A/Jx5RU/aW7RMusVUfrNFa+bJbaerVj35Hjt+rEjktaNiHS1N+v+rtoqbvIVjHBj1YpVx/UaJ4vfpJkyJK2epc/PyHdNfQdmENAs/EyWz2oIfo84Muz8TJbDZ78BaqLl+tP9yHr/073U53StVIZaeDdJfro/f+5cfqVVF/oSr7+i+vW9Uwz+iXzmiXa23+HoJ1bNCDNV8A5z7nlh82LuJye6hM9OHC5CRNHPxy6cdERM6xVHaMiIj2eDz01f7Tb1SInF+8lT759S+I7tcd7qPS9gHXVWlLKev2bPnf/9ty+ecVIrkruFtV9r4v3nT+f6xpGNHd/aU31A3DIkJ2ZYMerPkCOLt23v5J9XXh9eUr79HtO3epijjd/aWfXqa3b53Oph78SF/W6e4vlX8p1fwO0S1f1B/udfpg+4M7bjZsVeWTWz+gj8RW3fYR9bt3qcpuv+UzVPuN04qGqcqKNWMRIbuyQYC1WADnPueWqz984jIRXc4uS/MdUpHq65fpvd9uP/iUX1V2aVZc737pJ/Nb5v/1p1/h/FR95cWrtw19w6873Itv37b9a3/0+8rR5LLkcnuW3/ksvVOuVl9ZKN374dUg59eUfefTm65dsqZh8/8mlpXfLiwiZFM2edi37h5OdS4+Wf6meHeo7j5YdS4+eflWWl6uqyg4nZ1yzf315D9X6AMiIvos0W+JiOj20ZOn/sKpLesJfqW09odP7Fl4QjpWVV32Lg+9LV7bKA2b/ebk/AfU4D5YhxuG+2C2Z5MAA+hNdhgiAvQsBBgAQwgwAIYQYAAMIcAAGEKAATCEAANgCAEGwBACrJViKuAIpFIxhyCQKlrdIugiCDAz+ESCcrVarVZIUsIXy1vdHugaCDBTorl0iIjIGz+V5DLH0IuBSQgwM7hBn/TSOzBE/ErBytZAF0GAATCEADND1WUVV5cpOhqysjXQRRBgpmTCwsxGMXUgwSO+wDQbrMnRBbhkksIOBxFRNFdLI77ALPRg5uxLiwtJIrqgHQgwAIYQYAAMYU0OAIbQgwEwhAADYAgBBsAQAgyAIQQYAEMIMACG/h8YfihsGiXwOgAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="poisson-model-on-counts-diet" class="section level3">
<h3>Poisson model on counts (Diet)</h3>
<p>Apply the new glmperm implementation to the example OTU:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new</span>(ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> Education <span class="sc">+</span> PetAnimals <span class="sc">+</span> TravelToSE <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)),</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>otu.counts, <span class="at">test.var =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">method=</span><span class="st">&quot;glm.fit.fixed&quot;</span>, <span class="at">family=</span><span class="fu">poisson</span>())</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.536826e-296</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Apply the new glmperm implementation all OTUs, saving the likelihood and PRR test based p-values for Diet and DietRandom:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>pvals.data.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>pvals.null.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>pvals.data.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>pvals.null.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(taxa <span class="cf">in</span> taxas) {</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(taxa)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  eq1 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s ~ Diet + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE + offset(log(library_size))&quot;</span>, taxa))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  eq2 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s ~ DietRandom + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE + offset(log(library_size))&quot;</span>, taxa))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">prr.test.new</span>(eq1, <span class="at">data=</span>otu.counts, <span class="at">test.var =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">n.rep=</span><span class="dv">100</span>, <span class="at">method=</span><span class="st">&quot;glm.fit.fixed&quot;</span>, <span class="at">family=</span><span class="fu">poisson</span>())</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">prr.test.new</span>(eq2, <span class="at">data=</span>otu.counts, <span class="at">test.var =</span> <span class="st">&quot;DietRandom&quot;</span>, <span class="at">n.rep=</span><span class="dv">100</span>, <span class="at">method=</span><span class="st">&quot;glm.fit.fixed&quot;</span>, <span class="at">family=</span><span class="fu">poisson</span>()) </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  pvals.data.obs[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.obs</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  pvals.null.obs[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.obs</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  pvals.data.sim[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.sim</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  pvals.null.sim[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.sim</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Likelihood:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.obs, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.obs, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Likelihood: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>PRR test:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.sim, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.sim, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;PRR test: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="binomial-model-on-counts-diet" class="section level3">
<h3>Binomial model on counts (Diet)</h3>
<p>Apply the new glmperm implementation to the example OTU:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new</span>(<span class="fu">cbind</span>(ASV159, library_size <span class="sc">-</span> ASV159) <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> Education <span class="sc">+</span> PetAnimals <span class="sc">+</span> TravelToSE <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)),</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>otu.counts, <span class="at">test.var =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">method=</span><span class="st">&quot;glm.fit.fixed&quot;</span>, <span class="at">family=</span><span class="fu">binomial</span>())</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.027545e-266</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Apply the new glmperm implementation all OTUs, saving the likelihood and PRR test based p-values for Diet and DietRandom:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>pvals.data.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>pvals.null.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>pvals.data.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>pvals.null.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(taxa <span class="cf">in</span> taxas) {</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(taxa)</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  eq1 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;cbind(%s, library_size - %s) ~ Diet + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE&quot;</span>, taxa, taxa))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  eq2 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;cbind(%s, library_size - %s) ~ DietRandom + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE&quot;</span>, taxa, taxa))</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">prr.test.new</span>(eq1, <span class="at">data=</span>otu.counts, <span class="at">test.var =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">n.rep=</span><span class="dv">100</span>, <span class="at">method=</span><span class="st">&quot;glm.fit.fixed&quot;</span>, <span class="at">family=</span><span class="fu">binomial</span>())</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">prr.test.new</span>(eq2, <span class="at">data=</span>otu.counts, <span class="at">test.var =</span> <span class="st">&quot;DietRandom&quot;</span>, <span class="at">n.rep=</span><span class="dv">100</span>, <span class="at">method=</span><span class="st">&quot;glm.fit.fixed&quot;</span>, <span class="at">family=</span><span class="fu">binomial</span>()) </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  pvals.data.obs[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.obs</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  pvals.null.obs[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.obs</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  pvals.data.sim[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.sim</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  pvals.null.sim[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.sim</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Likelihood:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.obs, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.obs, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Likelihood: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAIAAACb4TnXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAbIElEQVR4nO3dfWwb530H8B/bxsvysi6pExcj6YgxKQyKgA6uW8LHqBANDC1piBUwQfOS1O627Gjtj5Aq4AaNhC0I4gBKgIgMBigkMCxWk8BQhMLlYLJdtzCYonOEeUYDKMIi0qUSkludpE23JmmSvtz+uDvy7ng8HSU+5Ony/SBAyOfunnvuzK/u7uHxOZcoigQAbHyq3w0AcDIEDIAhBAyAIQQMgCEEDIAhBAyAIQQMgCEEDIChPRCwcjrkcsULJhND6TIRUSHuaj/jtmuQK2n3mjXTrbQ6ayHebK/lxpfT8dBO9pqdFeIhlyRe6Mk/Xyt5/++BgAFT5YtLWaHfjeiuQjyq2iR/H1tC9Jm+rn33/IlVMWHrCvvFMRuyQ3xezET63Yg9cYpoyuREqJwOaU8Zy80Th1Co3amDYYWNBUNx3RRVna7WOk2nllW16hfc8dlu2w0ppw2aUk6HXIGkQJSNaua11mxXKJ4uqE5X5VNXab83Ts7KhXioUZt6ByoNVCpUJin1t+xr3fYZN7IQd7miWZI2yWAXKmfR7f9JW3airhLNv03brWsQba+U4oj4vMlELlUSRVHM89SYsZTiiIjPlzQzasmLaStpfc3z2iWbTcnz7evcZqq+OdJaGlWrN6WDHZLnm+to2RAtPq8vb+zFDpqt2SPSGjlOtZDh/JrZNXuXS+W1C7TbBe0bmefNl8/zBv+kqn+1bfe16p/GbOuU/e/IgEkbrt5rckkjcKW8HMCWSow+l83PLK//gKhCLL/XLttmqvQx4FLS1JLysWq3lQbb3JZBwOSPsrYpmg9CY8W7abZ2XvWaWgrUmyFNLinJ0Ow/40++eSPN/zwpq+G129B2z6s/D7q6TbfOwQHL8y3/Mvq9pKvWPGDqVRvsXnWdzVVbmKppj9H8pjuk44ARx/GpVL6k/8Rqdq95s1v3bOtHymgbSqVSPp9KNY4bxjtQV7vRv5mVRooWAqat1vR0QdcOg3mNt05Zbq9fg7XIRqNZIhKWLqrOhksbApGQDLhUAkmBaH1z205cbijQfBMY0p0ujmuuoyPjvKWppQ2BaHhQ1b/lPz5plppWbU8RDfgTszyRIGSTyWggIF88td/wds0ub64TcZPHTZut2V3yRUwgEIhGk8msQW+lbnbVTvEPDrdtoUkjLdHseukfdX2zTMrVo3JFlS6TvInKx6lwIate9XZbR3u/k6MVx+dLKY6E5BMO+25nNyIZsZRPNa48hGwyGujBd1+FeCApEHE8n0rl8/lSqd2fADtTJUybL0tb57iA8bOZiD9xLsVRNtr4CAWG2pxlriZ29y1J9oLmU1q4kLU0tfE3s6m0wfjLKH8kkVmVTmnyKb61dU3tmu0fHNafGpQvLpk0u7y5TsTnxdVMJpGIRCJ+f3lzfZebsV0jLdHsemkbhgf95E+sGn04GgnT5sva1jkuYBLppKgRMf/xSY6y0VDzxKhc0Hfid7yK45OctAq5znI6FM0q51DbTB0cJhKSp1Td5dFOPiAdKsRdLldj4/3+wOAQpz07Uz5x5s2OjPNEQvJUWumAT59KbvtnIXuhUVchLs1v4cTcjHkjrWjdBt0Zp8EKhY0ntOeHRGRl69pc2tlIu2v6lu4C3QWo9nLW6NykbY+2wWtVW1Sd6Tvupte3p+fd9Nr5VAW77aZv7QNps2qT/rmWjWnd0G33rWknB6ddfNvOpcaGqOc03TrHdnI0Rc6kOBKSp6Tv/iIZsdS8CCGO4/Ol3Z4gRjKrmjq1VW43tXlRxPH51TNDu2qKOX9ite3G+xOz0hRho1Tertn+xGqp+eHmeOlk02S95/LqqlL5Up4nEjZKu9wg8327reHZ1Xxj36fypW1v+VA6czTHL0tb5xIxqhTsXCHuiq6ndv2nqncKcVc028PbqBx8BINuk28+U99SFc3qO71BAwEDy+Tehcb3iYFolohLnbHBPbW2hYCBdWbXcmAI12AADOEIBsAQAgbAEAIGwBACBsAQAgbAkN0Hvdnc3Ox3E2hwcLC10LYNA1vBEQyAIQQMgCEEDIAhBAyAIQQMgCEEDIAhBAyAIQQMgCFnBKx2nh+dE5r/N5/LrKRnGqu2Vaug2+x+J0dnPCeyL7GcH6BDdj+CyX/Ijf+oC3Ojo+FweJR/7g2D2ZSpcokwd9/TJdcPHlLXoz6M8OfPz42Gw+FwOGz18GF48GmtRz2b5aPTirYSYW60WRt/vkbC3Ojc00/jx/p2Z/eAPSR9rDwnsi89qBuFTph76OrpZ4vF4kvfpB+UXNRm6rOnrz40JxBxDz57OiB+7bGWemSbT794x7PFYrF49muFZ87XrDTOqFU7qcdA4aq2Em4kcvXNGhHRm2/Qsbs9RESFR77/9R1WD71i94C1iwORsFKIfPOEh4iIuzceEFumDkqfQ8+Jb0YKKxYOGkptB+8Y3HzjTc2kH3XSZJN6dlEJN3LoxZdrRMLKVTlfRCe+dXqH1UOv2P0a7HyNTniMJtTevEo0Ir/xHDxEb+jn2Mx8I5whIiKRAnfUqLOnl6j95Crd+ac7XrpLDt5Bz7xcO/jG1WP3yjtkcPBQf5sE27N7wJ5+5PzdWaOIaTKlSZsicraoPfzt9HSN7jT4INeIDIPPjOfuY/TccyvNfMFeYPdTxPa4kYhyjSM8l9Ffg6mnzo3yO74Wkuzu8OU5eIjkC6jayy/u+GdknruPXS00zw+JNh/5h47OXaEP7B6wx6TDl1HnG/fgs8devC8cDo8+Q1/TX4MR9+Bjh56+LxwOjz509fTfnfAQkefuY4OFh7r0FVO7Vhnh7j1NmW+Ew+HwI3Rs5x1/nruPDR462Dx+DZ6gJ3dcGfSG3cdFtO0Ph/vQsNp5/rmDWfm0V5gbfeZLL790+s5etwI6YvcjGEhq5/nR+148du/Oe2qgL3AE255djmAtMCaH/eEIBsAQAgbAEAIGwJDdv2i+9dZbiWj//v3vvPNOo7Bfb/dEw8BWcAQDYKjrAasvJ2KxWCwWSyzXG4Vr861lxoUAjtLlgK3NT1XvyeVyudzMwOLjUnLqy4mzNJPL5XILIytT82vUthDAabobsDWhGOaCREQUnM6lJ9xERLVqRS50Hx3xFYW1toUATtPVTo56dcvn9c7HzhaJyHdyIT3hlgsnpRnc3gFaqdYpSEaFbrmaI0eONKq8fPmy9GL//v3qVfXrbWu53RoGttLtXsTKYvWeXG6aqL6ceHz5aHrCXatWyKufzbBQ0QgVEUl9Zf3trDP8KNu2YWAr3e7k8J2clE4R3d6BysqlOpHH62udzbAQwHG6egRzeweoalBYEWpEbiKqV7dogHMTkWHh3uN6aVX9VhzFIQU0unuKGOQGzi6tTUwHpUuvkUk3EXm8vuLzy5PBCXf90kolfE+Q2hW29dGDD9ysfj/3VFebvSsnb/1D6cXiz3/R35aADXX5Giw4PSPEYjEiovBMbtpNROSeSM9UY1OxRanjQz6DNCo08+svHJZeXPfqle62GYCdrt8qFZzO5aZ3XgjgKLhVCoAhBAyAIQQMgCEEDIAhBAyAIQQMgCEEDIAhBAyAIQQMgCEEDIAhBAyAIQQMgCEEDIAhBAyAIQQMgCEEDIAhBAyAIQQMgCEEDIAhBAyAIQQMgCEEDIAhuz/hUhp+/SOi66+/Xir5rapcN1sP3raUv95oWI9bgoHp9wS7B0x64sHNRB9++KFUcp2qXNLHhz+QqmG68n41DGwFp4gADCFgAAwhYAAMIWAADCFgAAwhYAAMIWAADCFgAAwhYAAMIWAADCFgAAwhYAAMIWAADCFgAAwhYAAMIWAADCFgAAwhYAAMIWAADCFgAAwhYAAMIWAADCFgAAwhYAAMMQpYfTkRm19rvF2bj8VisVgssVwn80IAR2ESsPry44sV1bvEWZrJ5XK5hZGVKTl2hoUATsMgYPXlx1cGwr7G+1q1EuaCRETuoyO+orDWthDAabo+Nn19+fGVkW9/mx4vVuWC6pbPOym9dnsHaKVapyAZFbrlKo4cOdKo7vLly4SHP3TSsE6U06FAcjgvZiL60o1ZXaFpHUuTpdWEv8MZtl3QEbocMCleaTctN4pq1Qp59fMZFiqkUEnw8IdOG9YJ//FJLpm8UMhEVGEqX1wS+Flr6SIif2JVTOyuGU7W1VNEKV4Tbk2hx+trndOwEHrOf3ySo/XNsqqofHFJ4Mct5wvMdTNg9UsrlcriVCwWi00tVqh4NpZYrpPbO1Cp1uQ5qls04HWTcSH0nj8xywtLF5sJ0+SrnA65mkLpslIYT8tT4oVyOqRMMZ5fcjFuVNpcrWrJeIHZ5vZeNwPmnkjnZAsnfRSeyaUn3EQer6/4/HKdpATKXRuGhdAHkXF1wtT5KsQDyeG8KCmlOCH5hPLRzyY3ZkVRFDUXaibzC8mloZJUTMmAPkHKpaC84HrUOIR7Ug++aHZPpGcGFqdisdjUysjCdLB9IfSDOmHqfJUDZ1QB0p1MGpxEms8/K/Vl+BPnUlz2UU2ACk8kBT6vLOlPzPKqaO51jJ5w6Z5I51Rvg9O53LR+HsNC6L3IOB999GI5kfBr+jf8fj8RFeKuaFaZk5tUXgwFWqoxm1+VR//gMAkbJSKlhvLmOpEQdWVVdRG3WaaIE7oXcasUNI5huv6NQtzlckXXUyXlnG+bajqdX4WTF2pwTOc9AgZKwgq6fF3IcqlS46Ne2hDMKzGbX9VRWd5c1x4A/YPDpOlncRQEDEhO2KMt/fPNa7N0KJo1XFKj7fxC8pTSBXkqKSgXZMrKz6S4xgzSgdA5vRyMrsFgj4mM89FsVvP9ciST513RgCtJRMSlSvnhQFR97dRShcn8XGpyI+ByERHx+htHiPyJ1RKFAvKixKUcdHsHAgZERBTJiGJmmzJRJCIi7a0bqjs5zOdPJLT1a24Bcez9IFZOEQvx1i//jMoAQAfXYAAMmZ0iltOhQFLpCtJ9T0FEfB43rAGYMzuC+ROroiiKYp4n4vOinsWfMwB8glnp5Ihk5KtVAOiMtWsw7V3SjrzrGYAFK0cw6cvB1q8vYM/75S9/uftKbr755t1X4lRWAlbaEKiDn7jC3rHv0Zku1DL3VBcqcSgrAQsMcbTBvCXQH787/KXdLP6pK//RrZY4kpVrMH9ils9GccUF0DFrd3JEs0TZKDo5ADpktZtef5saAFiAW6UAGLJ6s68RnCICbMNKwCIZ/V1SeZ64VAnfiwFsY2eniJFMfrj5E1SAVi13/zRPeMrpkMnpj/nUvWYX12DCRql77QAnUt8inqeokht/YvUTc1vQDn/RXLiQJS7V7sfjXSQNv46HP1hvmF1FMqVU6FS6HEn4NU+XaIzzJt2MV4gHkgJR1EXOuDfPSsA0Q90puFSpF+Mm4OEPnTbMvvyDw8KjF8sJ9dAAhXh0PVUSpdDFC2Imkiml1jt4uIvd4Xsw6JnAkH6oxMKFLDdZ8pN0u5BL95wXJ8D3YNAzhkMrCsmA1AkSzeqe8+IIVgOm6xNyzrh10DOFC1lu8rj+ukLdEeKc0doaLAVM8/QLURTF/HAygIxBJwrxaFY34ihRZJxXngRRiDvyz7alOzk0T78gksaYdNATMIAR9Q3iUcNuwUgmPyydI0bXU+cSfpKey5KNOuWrMAw8CmyYDCXqT6w2B3lp7UJz1CCklm6VOpPitL8HK8SjWS51xmEdPgBdZ+kIJo8dLo0tTkQOGz4cgBmrp4iOOmwD9Aq+BwNgyOIRrJwOBZYmpdNCpdPeIfeyfNJh1BqmLAVMfny8fNGlXJHFkbE97/rIn+++Egz7bMLSzb4XsronPfgTs3wy6sA7xz6B/nL/rbtZ/J/e+Xm3WuJIuAYDYAjfgwEwZPV7MHEw7sL3YAAdsnyrFH4UBtA5XIMBMISAATCEgAEbBg9t3OUvULo0nltvx5NDwIAdzZO9S6n1qF1+Utm78eQQMOgR//FJrjGWpuowIn+4y+lQKJ2Otx7slJHbQ0+oHlJXaJlRs3woXW4ut02oI5lSal36WbXmGKVbhTSeXMe/BEXAoEfKF5cEbihARFSIB5YmS43jmvKRFZJLQyVpaHZlIAFlXDdRFGcpq4yZ0yzMk+qoKCQ3xqU6KRlwXWi83u6n9/7BYWHpojaGjVUoDYxkSimOOn6SMgIG7GieKde4W5wokmmMb+MfHG7Or4zZERhSjnWFC42BPCJnUvKob+rCcb6ZDeXeB//xSa7xenB4+8Gq2ownd1wZTy57YceXft0OWH05EZPNrzVK1+alosRyncwLwUmUS508T8TJQ24olDOw1jFtVcqb6803ShY1ha3Z2AGG48l1N2Br81MrIwu5XC6XWzi5dVaKTn05cZZmcrlcbmFkZUqOnWEhOFQkU0pRMqC5vJHO4MRSyiwgmuObEixNoWE2OsRyPLmuBmxNKIbvmXATEZF74p5wpVojolq1EuaCRETuoyO+orBG7QrBsfyJc80bWsub68SPNy9lTI4P6nHdnkgKrYWG2egI2/HkujqqVHA6F2y8WROKPu8kUb265fNOSmVu7wCtVOsUJKNCt7zkkSNHGrVcvnyZ8PCHThpmV/7EudRSIBoaKq0mEudSyhAvHM9L11ttniQSyZQ2QwFXUpqzUZi/4Aq4kkTEN36n2Ils1NU8MzXsuFCtgkuVMsp4cslOn0rBaNi2+nLi7NbJhWk30Vq1Ql799JpRoUIKlQQPf+i0YXahGZutUZJoeUlE0j2uqvk1y6rnbdwNazjY26rR60hGjOhn7OF4cix6EdfmY1MrIwtp6WTR4/W1zmJYCOA4LHoRz9JMTk4XEbm9A9K1GBHVq1s04HW3KQRwnK4GrL6cmFocmMlNB9WlHq+v+LzUn3hpRenaMCwEcJpuXoPVL61UiCpnY0WlJDyTmw66J9Iz1dhUbJHId3IhLUXJsBDAaboZMPdEOjdhOCU4nctNWyqEXsOoNUzh4Q+faOJoqN9NcDjciwjAEAIGwBACBsAQAgbAEAIGwBACBsAQAgbAEAIGwBACBsAQAgbAEAIGwBACBsAQAgbAEAIGwBACBsAQAgbAEAIGwBACBsAQAgbAEAIGwBACBsCQ3UeVkoZfx8MfrDcMbMXuAcPDHzptGNgKThEBGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABjqY8DW5mOxWCwWSyzX+9cIAKb6FbD6cuIszeRyudzCyMrU/FqfmgHAVr8CVqtWwlyQiMh9dMRXFJyRMNdLq7etvy791++2gC30aejsenXL552UXru9A7RSrVPQLU88cuRIY8bLly8T0UdE1716pVH40YMP3Kyq7CMiRm9p7qltx6Zf/PkvDGe4bf11Il3MuvZWHN2PcbP3hD4FrFatkLfdRClUEmlA9v1zT/VyzPfG298jMh+bXhwN9aVh1L5hYCt9OkX0eH39WTFAT/UpYG7vQKVak17Xq1s04HWbLwCwJ/Wrk8Pj9RWfX64TUf3SitLfAeA0/Xo+mHsiPVONTcUWiXwnF9LIFzhTHx/AF5zO5ab7t3qAHsCtUgAMIWAALIl7wRe/+EUbTrVzw8AmcAQDYAgBA2AIAQNgyCWKYr/bAOBYOIIBMISAATCEgAEwhIABMNTHexHV1uZjZ4sk3fg70fLLle/+TeyFa0S07/DDyw8f1i3iufOG2k8+ICKiL8/kZoNERPXlxNRipWUt4ZncdFC9rNFk42WbDVM39VcP97dhmt1lvg+hT/r9TbcoirUXHhh78hXtq6b//Ps/G7t/UfuqOePFqbGxsW+9Iopi7R9Pjo399Qs1URTFV56Uptae/At5CVXN2tV95ztjY2NjY/ePPSAt2lz2hQfGEvePPfmK6pVm2fvHxvvWsJbdZb4PoW/scIpoPgDOa/WPD3zlG0REh2PD+679+3fVi6y9XKMDt5eENSL3V8cO0FtXaiSP+OEhole33rtp6Jiu5ubqav9VofWt8Ez4Jno//G3pr35j2Vq1MnzDtTAXJPfREd9PbjxQFNY0Tb3tut9ef6g/DWvdXc4cRMgBbHCKaDoADl25+u4+913S68OHbqH1q1eIDiiLeA77fNXbKlvVOgXdvyLat+86IqpVK5XiVGyRiIgqUzHppOsA+ap1ClJzdcHZmXDs+c++8uP3aICT16hZ9oYDJz1yq97boq3qFW+zqdc++B25fr9O5O5Dw95fmw4GVbuLTPch9I8NjmC1autFSdNr9Y9NFmkuW19OvPA+3T58QBqDwHdyIZc77SP67JDHd3Ihl8udvoHq69daV/f+q/9Gt9BtSjXKsjNhut3zwbv//EP1qKg/VS372s9+26+G+cb/6HntcK3m+xD6xwZHMPMBcO5y7/t++0U8Xh9Vid5fmZqik6e/VPkhEZF7Ip2bICKiEZ+PvjKw+HqNyP25G+njX/yU6Au61X1QOTDouaa8ay7r9e373//bd+W/a0SNQ8HnVcve9blPv/A//WkY0ecHKq+rG4ZBhOzKBkcw8wFwDh+65eP6a9LrK1ffpVsOHVYt4vYOVH58hd66cSaXPvqBflm3d6BS/ZlS89tEN3xOv7rX6L0DRw9eZ9iq2sc3vkcfyK266QMa8B5WLXvghk+R+Ct3PxqmWlauGYMI2ZUNArbNADh3ufdd+/7DV4joSm5d6e9QFqm/doXe/c2B048FVcuuzcvj3a/9qLiv+C8//jIXpPqlF6/dNPz1oG51L75104Gv/skfNNfWWJY8Xt/625+ht6v1+qWVyp3vXwtzQc2yb//60x9e7k/Div8qL9vYXRhEyKZscrNvy3c49eXEVPUe+duhlu/B6suJqSs30vp6S0Xhmdy0Z/lvp75Xo/eIiOgzRL8hIqJbxhfO/ZVbu6wv/OXK1h8/PLLysLKuunrZ2330lnxt02zY/D1TxfeozfdgPW4YvgezPZsEDMCZ7HCKCOBYCBgAQwgYAEMIGABDCBgAQwgYAEMIGABDCBgAQwjYdsrpkCuUTsddklC63O8WwR6CgFkhJJOUF0VRLKUoGYgX+t0e2DMQMEv4fCZCRORPnEtx2UdxFAOLEDAruKGA8tI/OEzCRqmfrYE9BAEDYAgBs0J1yCpvrhM/Hulna2APQcAsyUalno1y+lRSQL7AMhuMybEHcKkURV0uIiI+L2aQL7AKRzBrjmfkgSSRLugEAgbAEAIGwBDG5ABgCEcwAIYQMACGEDAAhhAwAIYQMACGEDAAhv4fHwdy0JB0E1EAAAAASUVORK5CYII=" /><!-- --></p>
<p>PRR test:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.sim, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.sim, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;PRR test: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="new-prr-test-implementation-for-any-model-with-zero-inflation" class="section level2">
<h2>New PRR-test implementation for any model (with zero-inflation)</h2>
<div id="test-and-illustrate-implementation" class="section level3">
<h3>Test and illustrate implementation</h3>
<p>Test the part of the function that splits the data into two model matrices, xyz=TRUE means to return the implicit model matrix 1) X: the count model matrix (before ‘|’ in formula) 2) Z: the zero-inflation model matrix (after ‘|’ in formula)</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) <span class="sc">|</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>data   <span class="ot">&lt;-</span> <span class="fu">prr.test.new.zeroinfl</span>(formula, otu.counts, <span class="at">test.var=</span><span class="st">&quot;Diet&quot;</span>, <span class="at">n.rep=</span><span class="dv">1</span>, <span class="at">xyz=</span><span class="cn">TRUE</span>)<span class="sc">$</span>data</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>YX <span class="ot">&lt;-</span> <span class="fu">with</span>(otu.counts, <span class="fu">cbind</span>(ASV159, library_size <span class="sc">-</span> ASV159))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 7</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ X      : num [1:149, 1:7] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:149] &quot;S1&quot; &quot;S10&quot; &quot;S100&quot; &quot;S101&quot; ...</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:7] &quot;(Intercept)&quot; &quot;Dietfisheater&quot; &quot;Dietvegan&quot; &quot;Dietvegetarian&quot; ...</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;assign&quot;)= int [1:7] 0 1 1 1 2 3 4</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;contrasts&quot;)=List of 2</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ Diet  : chr &quot;contr.treatment&quot;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ Gender: chr &quot;contr.treatment&quot;</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Z      : num [1:149, 1:5] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:149] &quot;S1&quot; &quot;S10&quot; &quot;S100&quot; &quot;S101&quot; ...</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:5] &quot;(Intercept)&quot; &quot;Dietfisheater&quot; &quot;Dietvegan&quot; &quot;Dietvegetarian&quot; ...</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;assign&quot;)= int [1:5] 0 1 1 1 2</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;contrasts&quot;)=List of 1</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ Diet: chr &quot;contr.treatment&quot;</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Y      : Named num [1:149] 80 15 103 0 23 28 91 137 141 15 ...</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:149] &quot;S1&quot; &quot;S10&quot; &quot;S100&quot; &quot;S101&quot; ...</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ offsetx: num [1:149] 11.2 10.9 11.1 10.8 10.4 ...</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ offsetz: num [1:149] 11.2 10.9 11.1 10.8 10.4 ...</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ weights: Named num [1:149] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:149] &quot;S1&quot; &quot;S10&quot; &quot;S100&quot; &quot;S101&quot; ...</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ YX     : num [1:149, 1:2] 80 15 103 0 23 28 91 137 141 15 ...</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:2] &quot;ASV159&quot; &quot;&quot;</span></span></code></pre></div>
<p>Test the part of the function that fits an arbitrary distribution to data:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (dist <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;negbin&quot;</span>, <span class="st">&quot;zipoisson&quot;</span>, <span class="st">&quot;zinegbin&quot;</span>, <span class="st">&quot;betabin&quot;</span>, <span class="st">&quot;zibinomial&quot;</span>, <span class="st">&quot;zibetabin&quot;</span>)) {</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="cf">if</span> (dist <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;betabin&quot;</span>, <span class="st">&quot;zibinomial&quot;</span>, <span class="st">&quot;zibetabin&quot;</span>)) data<span class="sc">$</span>YX <span class="cf">else</span> data<span class="sc">$</span>Y</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(data<span class="sc">$</span>X, Y, data<span class="sc">$</span>Z, <span class="dv">0</span>, <span class="dv">0</span>, data<span class="sc">$</span>weights, <span class="at">dist=</span>dist, <span class="at">control=</span><span class="fu">fitdist.control</span>(<span class="at">trace=</span>F))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(dist)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(fit<span class="sc">$</span>loglik)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;negbin&quot;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -761.737</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;zipoisson&quot;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -3973.347</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;zinegbin&quot;</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -721.3019</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;betabin&quot;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -745.5902</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;zibinomial&quot;</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -3174.943</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;zibetabin&quot;</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -708.5705</span></span></code></pre></div>
<p>Test the whole function that does the permutation test…</p>
<p>Apply a standard Negative Binomial distribution to the data and test for significance of Diet:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new.zeroinfl</span>(formula, otu.counts, <span class="at">test.var=</span><span class="st">&quot;Diet&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">dist=</span><span class="st">&quot;negbin&quot;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.005285936</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Apply a zero-inflated Negative Binomial distribution to the data and test for significance of Diet in both (count, zero) components simultaneously:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) <span class="sc">|</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new.zeroinfl</span>(formula, otu.counts, <span class="at">test.var=</span><span class="st">&quot;Diet&quot;</span>, <span class="at">test=</span><span class="st">&quot;both&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">dist=</span><span class="st">&quot;zinegbin&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 8.674702e-05</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Apply a zero-inflated Negative Binomial distribution to the data and test for significance of Diet in count component assuming a given model for zeros:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) <span class="sc">|</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new.zeroinfl</span>(formula, otu.counts, <span class="at">test.var=</span><span class="st">&quot;Diet&quot;</span>, <span class="at">test=</span><span class="st">&quot;count&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">dist=</span><span class="st">&quot;zinegbin&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 9.744612e-05</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Apply a zero-inflated Negative Binomial distribution to the data and test for significance of Diet in zero component assuming a given model for counts:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) <span class="sc">|</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new.zeroinfl</span>(formula, otu.counts, <span class="at">test.var=</span><span class="st">&quot;Diet&quot;</span>, <span class="at">test=</span><span class="st">&quot;zero&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">dist=</span><span class="st">&quot;zinegbin&quot;</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.07911633</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.093</span></span></code></pre></div>
</div>
<div id="zero-inflated-negative-binomial" class="section level3">
<h3>Zero-inflated Negative Binomial</h3>
<p>This is a standard negative binomial model:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> Education <span class="sc">+</span> PetAnimals <span class="sc">+</span> TravelToSE <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new.zeroinfl</span>(formula, otu.counts, <span class="at">test.var=</span><span class="st">&quot;Diet&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">dist=</span><span class="st">&quot;negbin&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.007071046</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>The zero-inflated negative binomial often provides a better fit, we could be interested in just the count component…</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> Education <span class="sc">+</span> PetAnimals <span class="sc">+</span> TravelToSE <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) <span class="sc">|</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new.zeroinfl</span>(formula, otu.counts, <span class="at">test.var=</span><span class="st">&quot;Diet&quot;</span>, <span class="at">test=</span><span class="st">&quot;count&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">dist=</span><span class="st">&quot;zinegbin&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.0001493719</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>… or both components simultaneously:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> ASV159 <span class="sc">~</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> UrbanizationLevel <span class="sc">+</span> Gender <span class="sc">+</span> Education <span class="sc">+</span> PetAnimals <span class="sc">+</span> TravelToSE <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size)) <span class="sc">|</span> Diet <span class="sc">+</span> Age <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(library_size))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prr.test.new.zeroinfl</span>(formula, otu.counts, <span class="at">test.var=</span><span class="st">&quot;Diet&quot;</span>, <span class="at">test=</span><span class="st">&quot;both&quot;</span>, <span class="at">n.rep=</span><span class="dv">1000</span>, <span class="at">dist=</span><span class="st">&quot;zinegbin&quot;</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.obs</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.0001364092</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p.value.sim</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Apply the new glmperm implementation all OTUs, saving the likelihood and PRR test based p-values for Diet and DietRandom:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>pvals.data.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>pvals.null.obs  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>pvals.data.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>pvals.null.sim  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(taxa <span class="cf">in</span> taxas) {</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  eq1 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s ~ Diet + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE + offset(log(library_size)) | Diet + Age + offset(log(library_size)) &quot;</span>, taxa))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  eq2 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s ~ DietRandom + Age + UrbanizationLevel + Gender + Education + PetAnimals + TravelToSE + offset(log(library_size)) | DietRandom + Age + offset(log(library_size)) &quot;</span>, taxa))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">prr.test.new.zeroinfl</span>(eq1, otu.counts, <span class="at">test.var =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">test=</span><span class="st">&quot;both&quot;</span>, <span class="at">n.rep=</span><span class="dv">100</span>, <span class="at">dist=</span><span class="st">&quot;zinegbin&quot;</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">prr.test.new.zeroinfl</span>(eq2, otu.counts, <span class="at">test.var =</span> <span class="st">&quot;DietRandom&quot;</span>, <span class="at">test=</span><span class="st">&quot;both&quot;</span>, <span class="at">n.rep=</span><span class="dv">100</span>, <span class="at">dist=</span><span class="st">&quot;zinegbin&quot;</span>) </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  pvals.data.obs[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.obs</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  pvals.null.obs[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.obs</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  pvals.data.sim[taxa]  <span class="ot">&lt;-</span> fit1<span class="sc">$</span>p.value.sim</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  pvals.null.sim[taxa]  <span class="ot">&lt;-</span> fit2<span class="sc">$</span>p.value.sim</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Likelihood:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.obs, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.obs, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Likelihood: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>PRR test:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: diet in data set&#39;</span>, <span class="at">p=</span>pvals.data.sim, <span class="at">Variable=</span><span class="st">&quot;Diet&quot;</span>),</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">experiment=</span><span class="st">&#39;p-values: null hypothesis&#39;</span>, <span class="at">p=</span>pvals.null.sim, <span class="at">Variable=</span><span class="st">&quot;Random Diet&quot;</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">color=</span>Variable, <span class="at">fill=</span>Variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>experiment) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;PRR test: Histogram of p-values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
